<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <title>ä¸€ç¬”ç”»æ¸¸æˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no" />
  <link href="okle/css/onstroke.css" rel="stylesheet">
</head>

<body>
	<div class="wrapper">
		<!-- å…³å¡åˆ—è¡¨ -->
		<ul class="levels" id="levels">
			<!-- <li class="level">
				<span class="level-no">001</span>
				<span class="level-name">ç¬¬ä¸€å…³</span>
				<div class="level-arrow"></div>
			</li> -->
		</ul>
		<div class="game" id="game">
			<div class="game-back" id="gameBack"></div>
			<canvas id="easel" width="375" height="500" class="easel"></canvas>
			<div class="game-control">
				<div class="game-control-reset">é‡æ–°å¼€å§‹ â˜¹</div>
				<div class="game-control-rollback">é€€å› â†</div>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript" src="okle/js/pixi.js"></script>
<script type="text/javascript" src="okle/js/tweenmax.js"></script>
<script type="text/javascript" src="okle/js/onestroke.js"></script>
<script type="text/javascript">
let onestroke = new OneStroke(
	{
		// é»˜è®¤çš„çº¿æ®µé¢œè‰²ä¸ç«¯ç‚¹é¢œè‰²
		lineColor: 0xe2e2e2, 
		vertexColor: 0x6dc6c0, 
		strokeColor: 0x416275, 
		activeVertexColor: 0x6dc6c0, 
		levels: [
			{
				name: "ç¬¬1å…³", 
				lineColor: 0xe2e2e2, 
				vertexColor: 0x90b34f, 
				strokeColor: 0x445624, 
				activeVertexColor: 0x90b34f, 
				lines: [
	                                                              {"x1": 140, "y1": 460, "x2": 140, "y2": 675},
					{"x1": 140, "y1": 675, "x2": 655, "y2": 675},
                                                                                {"x1": 655, "y1": 675, "x2": 655, "y2": 460},
                                                                                {"x1": 655, "y1": 460, "x2": 140, "y2": 460},
                                                                                {"x1": 140, "y1": 675, "x2": 655, "y2": 460},
				]
			}, 
		]
	}
); 

// å…¼å®¹å¤§å±å¹•é€‚é…
function fitEaselInfo() { 
	onestroke.viewLeft = document.querySelector(".wrapper").getBoundingClientRect().left; 
	onestroke.ratio = 375 / Math.min(document.body.clientWidth, 540); 
}
window.addEventListener("resize", fitEaselInfo); 

fitEaselInfo(); 

// é€šå…³
onestroke.event.on("pass", function() {
	console.log("é€šå…³"); 
	// è¿›å…¥ä¸‹ä¸€å…³
	onestroke.next(); 
}); 

// è¿›å…¥æ–°çš„ä¸€å…³
onestroke.event.on("start", function(curLevel) {
	gameBack.innerHTML = curLevel.name; 
}); 

// gameover
onestroke.event.on("gameover", function() {
	alert("ä½ çœŸæ£’ï¼ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘ğŸ‘"); 
}); 

// å…³å¡åŠ è½½ä¸­
onestroke.event.on("level-loading", function() {
	console.log("å…³å¡" + onestroke.curLevel + " åŠ è½½ä¸­...")
}); 

onestroke.event.on("level-loaded", function() {
	console.log("å…³å¡" + onestroke.curLevel + " åŠ è½½æˆåŠŸ")
}); 

// showOneStroke
let showOneStroke = function() {
	levels.style.transform = game.style.transform = "translate(-100%, 0)"; 
}

// hideOneStroke
let hideOneStroke = function() {
	levels.style.transform = game.style.transform = "translate(0, 0)"; 
}

// è¿›å…¥å¯¹åº”çš„å…³å¡
let enter = function(index) { 
	showOneStroke(); 
	onestroke.enter(index); 
}

// å…³å¡åˆ—è¡¨åˆå§‹åŒ–
let initLevels = function() { 
	let str = ''; 
	onestroke.config.levels.forEach(
		function(level, index) {
			str += '<li class="level" onclick="enter(' + index + ')">\
				<span class="level-no">' + (index + 1) + '</span>\
				<span class="level-name">' + level.name + '</span>\
				<div class="level-arrow"></div>\
			</li>'
		}
	); 
	levels.innerHTML = str; 
	// è¿”å›äº‹ä»¶
	gameBack.addEventListener("click", function() {hideOneStroke()}); 
	// é‡æ–°å¼€å§‹
	document.querySelector(".game-control-reset").addEventListener("click", function() {onestroke.restart()}); 
	// å›é€€
	document.querySelector(".game-control-rollback").addEventListener("click", function() { onestroke.rollback()}); 
}
// è°ƒç”¨åˆå§‹åŒ–åˆ—è¡¨ 
initLevels(); 

</script>



</html>
